<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr">

<!-- Mirrored from localhost/phpbb2/viewtopic.php?t=2492&start=0&postdays=0&postorder=asc&highlight= by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Mar 2018 20:55:27 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">

<link rel="top" href="index-2.html" title="VB Decompiler Forum Index" />
<link rel="search" href="search.html" title="Search" />
<link rel="help" href="faq.html" title="FAQ" />
<link rel="author" href="memberlist.html" title="Memberlist" />
<link rel="prev" href="viewtopicc423.html" xx="t=2492&amp;view=previous" title="View previous topic" />
<link rel="next" href="viewtopicaaab.html" xx="t=2492&amp;view=next" title="View next topic" />
<link rel="up" href="viewforum8941.html" xx="f=22" title="Articles" />

<title>VB Decompiler :: View topic - VISUAL BASIC REVERSED - A decompiling approach</title>
<!-- link rel="stylesheet" href="templates/subSilver/subSilver.css" type="text/css" -->
<style type="text/css">
<!--
/*
  The original subSilver Theme for phpBB version 2+
  Created by subBlue design
  http://www.subBlue.com

  NOTE: These CSS definitions are stored within the main page body so that you can use the phpBB2
  theme administration centre. When you have finalised your style you could cut the final CSS code
  and place it in an external file, deleting this section to save bandwidth.
*/

/* General page style. The scroll bar colours only visible in IE5.5+ */
body {
	background-color: #E5E5E5;
	scrollbar-face-color: #DEE3E7;
	scrollbar-highlight-color: #FFFFFF;
	scrollbar-shadow-color: #DEE3E7;
	scrollbar-3dlight-color: #D1D7DC;
	scrollbar-arrow-color:  #006699;
	scrollbar-track-color: #EFEFEF;
	scrollbar-darkshadow-color: #98AAB1;
}

/* General font families for common tags */
font,th,td,p { font-family: Verdana, Arial, Helvetica, sans-serif }
a:link,a:active,a:visited { color : #006699; }
a:hover		{ text-decoration: underline; color : #DD6900; }
hr	{ height: 0px; border: solid #D1D7DC 0px; border-top-width: 1px;}

/* This is the border line & background colour round the entire page */
.bodyline	{ background-color: #FFFFFF; border: 1px #98AAB1 solid; }

/* This is the outline round the main forum tables */
.forumline	{ background-color: #FFFFFF; border: 2px #006699 solid; }

/* Main table cell colours and backgrounds */
td.row1	{ background-color: #EFEFEF; }
td.row2	{ background-color: #DEE3E7; }
td.row3	{ background-color: #D1D7DC; }

/*
  This is for the table cell above the Topics, Post & Last posts on the index.php page
  By default this is the fading out gradiated silver background.
  However, you could replace this with a bitmap specific for each forum
*/
td.rowpic {
		background-color: #FFFFFF;
		background-image: url(templates/subSilver/images/cellpic2.jpg);
		background-repeat: repeat-y;
}

/* Header cells - the blue and silver gradient backgrounds */
th	{
	color: #FFA34F; font-size: 11px; font-weight : bold;
	background-color: #006699; height: 25px;
	background-image: url(templates/subSilver/images/cellpic3.gif);
}

td.cat,td.catHead,td.catSides,td.catLeft,td.catRight,td.catBottom {
			background-image: url(templates/subSilver/images/cellpic1.gif);
			background-color:#D1D7DC; border: #FFFFFF; border-style: solid; height: 28px;
}

/*
  Setting additional nice inner borders for the main table cells.
  The names indicate which sides the border will be on.
  Don't worry if you don't understand this, just ignore it :-)
*/
td.cat,td.catHead,td.catBottom {
	height: 29px;
	border-width: 0px 0px 0px 0px;
}
th.thHead,th.thSides,th.thTop,th.thLeft,th.thRight,th.thBottom,th.thCornerL,th.thCornerR {
	font-weight: bold; border: #FFFFFF; border-style: solid; height: 28px;
}
td.row3Right,td.spaceRow {
	background-color: #D1D7DC; border: #FFFFFF; border-style: solid;
}

th.thHead,td.catHead { font-size: 12px; border-width: 1px 1px 0px 1px; }
th.thSides,td.catSides,td.spaceRow	 { border-width: 0px 1px 0px 1px; }
th.thRight,td.catRight,td.row3Right	 { border-width: 0px 1px 0px 0px; }
th.thLeft,td.catLeft	  { border-width: 0px 0px 0px 1px; }
th.thBottom,td.catBottom  { border-width: 0px 1px 1px 1px; }
th.thTop	 { border-width: 1px 0px 0px 0px; }
th.thCornerL { border-width: 1px 0px 0px 1px; }
th.thCornerR { border-width: 1px 1px 0px 0px; }

/* The largest text used in the index page title and toptic title etc. */
.maintitle	{
	font-weight: bold; font-size: 22px; font-family: "Trebuchet MS",Verdana, Arial, Helvetica, sans-serif;
	text-decoration: none; line-height : 120%; color : #000000;
}

/* General text */
.gen { font-size : 12px; }
.genmed { font-size : 11px; }
.gensmall { font-size : 10px; }
.gen,.genmed,.gensmall { color : #000000; }
a.gen,a.genmed,a.gensmall { color: #006699; text-decoration: none; }
a.gen:hover,a.genmed:hover,a.gensmall:hover	{ color: #DD6900; text-decoration: underline; }

/* The register, login, search etc links at the top of the page */
.mainmenu		{ font-size : 11px; color : #000000 }
a.mainmenu		{ text-decoration: none; color : #006699;  }
a.mainmenu:hover{ text-decoration: underline; color : #DD6900; }

/* Forum category titles */
.cattitle		{ font-weight: bold; font-size: 12px ; letter-spacing: 1px; color : #006699}
a.cattitle		{ text-decoration: none; color : #006699; }
a.cattitle:hover{ text-decoration: underline; }

/* Forum title: Text and link to the forums used in: index.php */
.forumlink		{ font-weight: bold; font-size: 12px; color : #006699; }
a.forumlink 	{ text-decoration: none; color : #006699; }
a.forumlink:hover{ text-decoration: underline; color : #DD6900; }

/* Used for the navigation text, (Page 1,2,3 etc) and the navigation bar when in a forum */
.nav			{ font-weight: bold; font-size: 11px; color : #000000;}
a.nav			{ text-decoration: none; color : #006699; }
a.nav:hover		{ text-decoration: underline; }

/* titles for the topics: could specify viewed link colour too */
.topictitle,h1,h2	{ font-weight: bold; font-size: 11px; color : #000000; }
a.topictitle:link   { text-decoration: none; color : #006699; }
a.topictitle:visited { text-decoration: none; color : #5493B4; }
a.topictitle:hover	{ text-decoration: underline; color : #DD6900; }

/* Name of poster in viewmsg.php and viewtopic.php and other places */
.name			{ font-size : 11px; color : #000000;}

/* Location, number of posts, post date etc */
.postdetails		{ font-size : 10px; color : #000000; }

/* The content of the posts (body of text) */
.postbody { font-size : 12px; line-height: 18px}
a.postlink:link	{ text-decoration: none; color : #006699 }
a.postlink:visited { text-decoration: none; color : #5493B4; }
a.postlink:hover { text-decoration: underline; color : #DD6900}

/* Quote & Code blocks */
.code {
	font-family: Courier, 'Courier New', sans-serif; font-size: 11px; color: #006600;
	background-color: #FAFAFA; border: #D1D7DC; border-style: solid;
	border-left-width: 1px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px
}

.quote {
	font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px; color: #444444; line-height: 125%;
	background-color: #FAFAFA; border: #D1D7DC; border-style: solid;
	border-left-width: 1px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px
}

/* Copyright and bottom info */
.copyright		{ font-size: 10px; font-family: Verdana, Arial, Helvetica, sans-serif; color: #444444; letter-spacing: -1px;}
a.copyright		{ color: #444444; text-decoration: none;}
a.copyright:hover { color: #000000; text-decoration: underline;}

/* Form elements */
input,textarea, select {
	color : #000000;
	font: normal 11px Verdana, Arial, Helvetica, sans-serif;
	border-color : #000000;
}

/* The text input fields background colour */
input.post, textarea.post, select {
	background-color : #FFFFFF;
}

input { text-indent : 2px; }

/* The buttons used for bbCode styling in message post */
input.button {
	background-color : #EFEFEF;
	color : #000000;
	font-size: 11px; font-family: Verdana, Arial, Helvetica, sans-serif;
}

/* The main submit button option */
input.mainoption {
	background-color : #FAFAFA;
	font-weight : bold;
}

/* None-bold submit button */
input.liteoption {
	background-color : #FAFAFA;
	font-weight : normal;
}

/* This is the line in the posting page which shows the rollover
  help line. This is actually a text box, but if set to be the same
  colour as the background no one will know ;)
*/
.helpline { background-color: #DEE3E7; border-style: none; }

/* Import the fancy styles for IE only (NS4.x doesn't use the @import function) */
@import url("templates/subSilver/formIE.css");
-->
</style>
</head>
<body bgcolor="#E5E5E5" text="#000000" link="#006699" vlink="#5493B4">

<a name="top"></a>

<table width="100%" cellspacing="0" cellpadding="10" border="0" align="center">
	<tr>
		<td class="bodyline"><table width="100%" cellspacing="0" cellpadding="0" border="0">
			<tr>
				<td><a href="index-2.html"><img src="templates/subSilver/images/logo_phpBB.gif" border="0" alt="VB Decompiler Forum Index" vspace="1" /></a></td>
				<td align="center" width="100%" valign="middle"><span class="maintitle">VB Decompiler</span><br /><span class="gen">Hosted by TheAutomaters.com<br />&nbsp; </span>
				<table cellspacing="0" cellpadding="2" border="0">
					<tr>
						<td align="center" valign="top" nowrap="nowrap"><span class="mainmenu">&nbsp;
						<a href="memberlist.html" class="mainmenu"><img src="templates/subSilver/images/icon_mini_members.gif" width="12" height="13" border="0" alt="Memberlist" hspace="3" />Memberlist</a>
						</span></td>
					</tr>
					<tr>
						<td height="25" align="center" valign="top" nowrap="nowrap"><span class="mainmenu">&nbsp;</td>
					</tr>
				</table></td>
			</tr>
		</table>

		<br />


<table width="100%" cellspacing="2" cellpadding="2" border="0">
  <tr>
	<td align="left" valign="bottom" colspan="2"><a class="maintitle" href="viewtopicb351.html" xx="t=2492&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;highlight=">VISUAL BASIC REVERSED - A decompiling approach</a><br />
	  <span class="gensmall"><b></b><br />
	  &nbsp; </span></td>
  </tr>
</table>

<table width="100%" cellspacing="2" cellpadding="2" border="0">
  <tr>
	<td></td>
	<td align="left" valign="middle" width="100%"><span class="nav">&nbsp;&nbsp;&nbsp;<a href="index-2.html" class="nav">VB Decompiler Forum Index</a>
	  -> <a href="viewforum8941.html" xx="f=22" class="nav">Articles</a></span></td>
  </tr>
</table>

<table class="forumline" width="100%" cellspacing="1" cellpadding="3" border="0">
	<tr>
		<th class="thLeft" width="150" height="26" nowrap="nowrap">Author</th>
		<th class="thRight" nowrap="nowrap">Message</th>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row1"><span class="name"><a name="3831"></a><b>_aLfa_</b></span><br /><span class="postdetails">Site Admin<br /><!--<img src="pro_rank_admin.gif" alt="Site Admin" title="Site Admin" border="0" /><br />--><br /><br />Joined: 21 Sep 2002<br />Posts: 233<br />Location: Aveiro, Portugal</span><br /></td>
		<td class="row1" width="100%" height="28" valign="top">
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
				<tr>
					<td width="100%">
						<span class="postdetails">
							Posted: Fri Feb 15, 2008 10:54 pm
							<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: VISUAL BASIC REVERSED - A decompiling approach
						</span>
					</td>
				</tr>
				<tr>
					<td colspan="2"><hr /></td>
				</tr>
				<tr>
					<td colspan="2">
						<span class="postbody"><span style="color: #808080"><span style="font-style: italic">AndreaGeddon
<br />
Reverse Engineering Team</span></span>
<br />

<br />
<span style="font-weight: bold">Abstract</span>
<br />

<br />
<span style="font-style: italic">Keywords: Reverse Code Engineering, Visual Basic, VB, Decompiling
<br />

<br />
Frameworks are getting more and more popular today, Visual Basic is one of them. Personally I hate frameworks, and also most reversers do. So, why this tutorial? We can consider both the light and the dark side of the problem: frameworks usually put a lot of code in the compiled programs, so it becomes hard to find the way among all that jungle. But they also use sets of pre-built objects, so these objects are always the same and can be recognized, helping the reverser to understand the code itself. In a VB PE you have alot of information inside the exe, so you can easily extract all the information you need about all components of the program. To analyze a VB application I used this program that was written by a friend of mine (thank you </span>_d31m0s_<span style="font-style: italic">!). It's a sort of name/serial crackme, but we are not interested in serial fishing, we are interested in how it works and how VB knows how to build the app itself. I asked my friend to write it adding some event handling (colors, on over, etc...) and a simple algorithm to check serial. He also wrote the proggy using more source files and making various subs (some null sub too). We also have the source of all, but we will check them later.
<br />

<br />
Let's make some introduction now!</span><br />_________________<br /><span style="font-style: italic">One thing only I know, and that is that I know nothing.</span> (Socrates)</span>
						<span class="gensmall"></span>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="row1" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap"></td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/subSilver/images/spacer.gif" alt="" width="1" height="1" /></td>
		<td></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="3832"></a><b>_aLfa_</b></span><br /><span class="postdetails">Site Admin<br /><!--<img src="pro_rank_admin.gif" alt="Site Admin" title="Site Admin" border="0" /><br />--><br /><br />Joined: 21 Sep 2002<br />Posts: 233<br />Location: Aveiro, Portugal</span><br /></td>
		<td class="row2" width="100%" height="28" valign="top">
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
				<tr>
					<td width="100%">
						<span class="postdetails">
							Posted: Fri Feb 15, 2008 10:57 pm
							<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: 1 - INTRODUCTION
						</span>
					</td>
				</tr>
				<tr>
					<td colspan="2"><hr /></td>
				</tr>
				<tr>
					<td colspan="2">
						<span class="postbody">Before VB5 the VB programs were not truly traduced in assembler, they were coded in Pseudo Code (hehe you all remember those hating pcode exe!), and the VB virtual machine had the task of itnerpreting the pseudo code and execute it. Those programs were linked to vbrun100, vbrun200, vbrun300, vbrun400 dlls (depending on the version); well thing are a little different because there were variations between 16bit and 32bit modules (pcode were mostly 16bit apps), but this is not what we are looking for. Today we have version 5 and 6 of VB, they use MSVBVM50.dll and MSVBVM60.dll, and now VB exes are really compiled and traduced in asm. As you all know you can't use usual breakpoints like &quot;GetWindowTextA&quot; when debugging VB programs, infact you should use the apis exported from the VBVM dll (e.g. for a serial I would use __vbaStrCmp, or rtcMsgBox), if you want to use these apis in softice you just have to load the VB dll (in winice.dat or via symbol loader). This will help you debug VB applications.<br />_________________<br /><span style="font-style: italic">One thing only I know, and that is that I know nothing.</span> (Socrates)</span>
						<span class="gensmall"></span>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap"></td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/subSilver/images/spacer.gif" alt="" width="1" height="1" /></td>
		<td></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row1"><span class="name"><a name="3833"></a><b>_aLfa_</b></span><br /><span class="postdetails">Site Admin<br /><!--<img src="pro_rank_admin.gif" alt="Site Admin" title="Site Admin" border="0" /><br />--><br /><br />Joined: 21 Sep 2002<br />Posts: 233<br />Location: Aveiro, Portugal</span><br /></td>
		<td class="row1" width="100%" height="28" valign="top">
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
				<tr>
					<td width="100%">
						<span class="postdetails">
							Posted: Fri Feb 15, 2008 11:01 pm
							<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: 2 - ANALISYS
						</span>
					</td>
				</tr>
				<tr>
					<td colspan="2"><hr /></td>
				</tr>
				<tr>
					<td colspan="2">
						<span class="postbody">Let's start disassembling the proggy. I am using Ida, I advice you to use it too, but you can use other disassemblers if you want. First of all lets have a general look, so we can have a general idea. You can easily see the following:
<br />

<br />
[code=text:nmwo94j5]<div class="text" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00401000</li><li style="" class="li2">&nbsp;... &nbsp; &nbsp; &nbsp;IAT (First Thunk ok apis)</li><li style="" class="li1">004010F0</li><li style="" class="li2">&nbsp;... &nbsp; &nbsp; &nbsp;some data</li><li style="" class="li1">004011A5</li><li style="" class="li2">&nbsp;... &nbsp; &nbsp; &nbsp;transfer area (declspec(dllimport) style)</li><li style="" class="li1">0040130E</li><li style="" class="li2">&nbsp;... &nbsp; &nbsp; &nbsp;lots of data</li><li style="" class="li1">004023EC</li><li style="" class="li2">&nbsp;... &nbsp; &nbsp; &nbsp;local transfer area (for internal event handlers)</li><li style="" class="li1">0040242C</li><li style="" class="li2">&nbsp;... &nbsp; &nbsp; &nbsp;other data</li><li style="" class="li1">00402E44</li><li style="" class="li2">&nbsp;... &nbsp; &nbsp; &nbsp;code</li><li style="" class="li1">00403D06</li><li style="" class="li2">&nbsp;... &nbsp; &nbsp; &nbsp;other data</li></ol></div></td>	</tr></table><span class="postbody">
<br />

<br />
Ok we have a general idea of the mapping of the program. Notice that all read only data is in the .text section, the data before and after the code contains names of imported function (IT original first thunks), however now we begin analisys.
<br />

<br />
We start from entry point. What we see is:
<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00401310</span> <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> RT_MainStruct</li><li style="" class="li2"><span style="color: #ff0000;">00401315</span> <span style="color: #00007f;">call</span> ThunRTMain</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
if you debug this, you execute the call the program runs. The analisys here is very simple: the entry point simply consists of:
<br />

<br />
  ThunRTMain(&amp;RT_Main_Struct);
<br />

<br />
this function is the main function of the VBVM (the Thunder Runtime Engine) and has one parameter, the pointer to a complex structure that describes all the application. It is clear that all the data, all the callbacks and so on are described by this structure, so we can extract alot of information. We just have to check this big structure! Let's go!
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00401970</span> &nbsp;RT_MainStruct <span style="color: #0000ff;">db</span> ’VB5!’ &nbsp; <span style="color: #adadad; font-style: italic;">;signature</span></li><li style="" class="li2"><span style="color: #ff0000;">00401974</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">db</span> 1Ch <span style="color: #adadad; font-style: italic;">;</span></li><li style="" class="li1"><span style="color: #ff0000;">00401975</span> &nbsp;aVb6it_dll &nbsp; &nbsp;<span style="color: #0000ff;">db</span> ’#VB6IT.DLL’,<span style="color: #ff0000;">0</span> &nbsp;<span style="color: #adadad; font-style: italic;">;italian language</span></li><li style="" class="li2"><span style="color: #ff0000;">00401980</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00401984</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 2Ah</li><li style="" class="li2"><span style="color: #ff0000;">00401988</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">0040198C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00401990</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0A0000h</span></li><li style="" class="li1"><span style="color: #ff0000;">00401994</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 410h</li><li style="" class="li2"><span style="color: #ff0000;">00401998</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">4</span><span style="color: #ff0000;">09h</span></li><li style="" class="li1">0040199C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">004019A0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> ProjectStruct</li><li style="" class="li1">004019A4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span><span style="color: #ff0000;">0F016h</span></li><li style="" class="li2">004019A8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFF00h</span></li><li style="" class="li1">004019AC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">8</span></li><li style="" class="li2">004019B0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1</span></li><li style="" class="li1">004019B4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">2</span></li><li style="" class="li2">004019B8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0E9h</span></li><li style="" class="li1">004019BC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> DialogsStruct</li><li style="" class="li2">004019C0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> ExternStruct</li><li style="" class="li1">004019C4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> ProjectInfo</li><li style="" class="li2">004019C8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 78h</li><li style="" class="li1">004019CC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 7Eh</li><li style="" class="li2">004019D0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 84h</li><li style="" class="li1">004019D4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 85h</li><li style="" class="li2">004019D8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">004019DC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">004019E0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">004019E4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
the first field is the signature of the struct itself. Note that the program has been written with VB 6.0, but the signature is &quot;VB5!&quot;, probably they didn't change it for cross compatibility? Or just forgot it? Who knows! However we can see various infos, the &quot;VB6IT.dll&quot; that should be the module to load the language (the app has been written with italian version of vb). What should really abtract your attention are four pointers (ProjectStruct, DialogStruct, ExternStruct, ProjectInfo). I gave them a name because I know their function, you should see just four addresses in the dasm. However we will analyse these structs to find infos we need.
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">0040131C ProjectInfo <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span> <span style="color: #adadad; font-style: italic;">; DATA XREF: 004019C4o</span></li><li style="" class="li2"><span style="color: #ff0000;">00401320</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 30h</li><li style="" class="li1"><span style="color: #ff0000;">00401324</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 40h</li><li style="" class="li2"><span style="color: #ff0000;">00401328</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">0040132C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0EACF9A13h</span></li><li style="" class="li2"><span style="color: #ff0000;">00401330</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 4F93898Bh</li><li style="" class="li1"><span style="color: #ff0000;">00401334</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0DF0C5493h</span></li><li style="" class="li2"><span style="color: #ff0000;">00401338</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 159AAEEDh</li><li style="" class="li1">0040133C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00401340</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1</span><span style="color: #ff0000;">0000h</span></li><li style="" class="li1"><span style="color: #ff0000;">00401344</span> a020430progetto <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">0</span>,<span style="color: #ff0000;">0</span>,’020430Progetto1’,<span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00401356</span> aC000 &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">db</span> ’-C000-’</li><li style="" class="li1">0040135C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span> <span style="color: #adadad; font-style: italic;">;</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
here we can see various numbers, in particula there is the project name as last field. If we go and search in the source of the app, we can see in the .vbp the following line
<br />

<br />
Reference=*\G{00020430-0000-0000-C000-000000000046}#2.0#0#D:\WINNT\System32\STDOLE2.TLB#OLE Automation
<br />

<br />
so we can think all the data bytes represent the type of project, modules contained etc etc. This isn't very useful, so we go on. We go back to main struct and see another sub structure:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">004018F8 &nbsp;ExternStruct <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">6</span> &nbsp; <span style="color: #adadad; font-style: italic;">;flag</span></li><li style="" class="li2">004018FC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> InsideImport &nbsp; <span style="color: #adadad; font-style: italic;">;import data</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
it is a bit harder to figure out what this structure is. This handles other imported functions, they can be inside or outside virtual machine module. The flag indicates the type of import (6 = inside, 7 = outside). If you look at InsideImport you will find:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00402B64 &nbsp;InsideImport <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Descr</li><li style="" class="li2">00402B68 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Thunk</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
Descr will point to four dwords that seem to be the same in all vb apps. Thunk will contain a pointer to an area where addresses (of some code of the cirtual machine) are stored. I analysed an other vb app, its ExternStruct is:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #adadad; font-style: italic;">;snippet from another vb app</span></li><li style="" class="li2">&nbsp;00401A5C &nbsp;ExternStruct <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">7</span> &nbsp;<span style="color: #adadad; font-style: italic;">;outside</span></li><li style="" class="li1">&nbsp;00401A60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ImportData</li><li style="" class="li2">&nbsp;00401A64 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">6</span> &nbsp;<span style="color: #adadad; font-style: italic;">;inside</span></li><li style="" class="li1">&nbsp;00401A68 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;InsideImport</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;end snippet from another vb app</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
as you can see in that app there was an external function, infact the app used ShellExecute to open the internet browser and link to a site. The ImportData is as follows:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #adadad; font-style: italic;">;snippet from another vb app</span></li><li style="" class="li2">&nbsp;00402DA4 &nbsp;ImportData <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aShell32 &nbsp;<span style="color: #adadad; font-style: italic;">;modulename</span></li><li style="" class="li1">&nbsp;00402DA8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aShellexecutea &nbsp;<span style="color: #adadad; font-style: italic;">;apiname</span></li><li style="" class="li2">&nbsp;00402DAC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">align</span> <span style="color: #ff0000;">8</span></li><li style="" class="li1">&nbsp;00402DB0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;IAT_Data</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;end snippet from another vb app</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
where you can see you have the pointers to the name of the module and the name of the api to import. The IAT_Data fields points to thunking data (hInstance of module and api address). This data is also used from the primitive DLL_Import of VB, used to thunk to ouside apis. Back to our app, we check the DialogStruct pointer:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"> 00401A00 &nbsp;DialogsStruct<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> 50h &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;sizeof struct</span></li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;00401A04 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">356</span><span style="color: #ff0000;">022C6h</span></li><li style="" class="li2">&nbsp;00401A08 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">4</span><span style="color: #ff0000;">00E3F28h</span></li><li style="" class="li1">&nbsp;00401A0C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">49524</span><span style="color: #ff0000;"><span style="color: #ff0000;">0B</span>8h</span></li><li style="" class="li2">&nbsp;00401A10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0C949<span style="color: #ff0000;">1B</span>B6h</span></li><li style="" class="li1">&nbsp;00401A14 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A18 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401A1C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A20 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401A24 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A28 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 310h</li><li style="" class="li1">&nbsp;00401A2C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A30 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401A34 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A38 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401A3C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A40 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 596h</li><li style="" class="li1">&nbsp;00401A44 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A48 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;MainDialog</li><li style="" class="li1">&nbsp;00401A4C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 4Ch</li><li style="" class="li2">&nbsp;00401A50 &nbsp;DialogsStruct<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> 50h &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;sizeofstruct</span></li><li style="" class="li1">&nbsp;00401A54 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 78CBBB9Fh</li><li style="" class="li2">&nbsp;00401A58 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">4</span><span style="color: #ff0000;">01EB563h</span></li><li style="" class="li1">&nbsp;00401A5C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0DB8<span style="color: #ff0000;">0B</span>296h</span></li><li style="" class="li2">&nbsp;00401A60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 7EFFD31Ah</li><li style="" class="li1">&nbsp;00401A64 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A68 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401A6C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A70 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401A74 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span></li><li style="" class="li2">&nbsp;00401A78 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1</span><span style="color: #ff0000;">00h</span></li><li style="" class="li1">&nbsp;00401A7C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A80 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401A84 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A88 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401A8C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A90 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 1A3h</li><li style="" class="li1">&nbsp;00401A94 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;00401A98 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;AboutDialog</li><li style="" class="li1">&nbsp;00401A9C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 9Ch</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
we have an array of dialog descriptors. Each descriptor has various data values, in particular has in the 19th field a pointer to a struct were the resource info are stored. These structure have variable size, because it depends on the data contained by the resources. Lets go and see MainDialog; I will not paste all the data but only the important things.
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">004013C2 &nbsp;aForm1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">db</span> <span style="color: #ff0000;">5</span>,<span style="color: #ff0000;">0</span>,’Form1’,<span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;004013CC aLeimcrackme &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;"><span style="color: #ff0000;">0B</span>h</span>,<span style="color: #ff0000;">0</span>,’Leimcrackme’,<span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;</li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;004013E2 IconData &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">6</span>,<span style="color: #ff0000;">3</span>,<span style="color: #ff0000;">0</span>,<span style="color: #ff0000;">0</span>,6Ch,74h,<span style="color: #ff0000;">0</span>,<span style="color: #ff0000;">0</span>,<span style="color: #ff0000;">0FEh</span>...</li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;004016FA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dw</span> 2Dh <span style="color: #adadad; font-style: italic;">; clientleft</span></li><li style="" class="li2">&nbsp; 004016FE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dw</span> 14Ah <span style="color: #adadad; font-style: italic;">; clienttop</span></li><li style="" class="li1">&nbsp; <span style="color: #ff0000;">00401702</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dw</span> 1248h <span style="color: #adadad; font-style: italic;">; clientwidth</span></li><li style="" class="li2">&nbsp; <span style="color: #ff0000;">00401706</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dw</span> <span style="color: #ff0000;"><span style="color: #ff0000;">0B</span>7Ch</span> <span style="color: #adadad; font-style: italic;">; clientheight</span></li><li style="" class="li1">&nbsp;</li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp; <span style="color: #ff0000;">00401715</span> &nbsp;aText2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">db</span> <span style="color: #ff0000;">5</span>,<span style="color: #ff0000;">0</span>,’Text2’,<span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00401731</span> &nbsp;aText1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">db</span> <span style="color: #ff0000;">5</span>,<span style="color: #ff0000;">0</span>,’Text1’,<span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;0040174D &nbsp;aCommand2 &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">8</span>,<span style="color: #ff0000;">0</span>,’Command2’,<span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp; 0040175A &nbsp;aCheck &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">db</span> <span style="color: #ff0000;">7</span>,<span style="color: #ff0000;">0</span>,’&amp;Check!’,<span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00401777</span> &nbsp;aCommand1 &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">8</span>,<span style="color: #ff0000;">0</span>,’Command1’,<span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp; <span style="color: #ff0000;">00401784</span> &nbsp;aAbout &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">db</span> <span style="color: #ff0000;">6</span>,<span style="color: #ff0000;">0</span>,’&amp;About’,<span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp; 004017A2 &nbsp;aLabel2 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">6</span>,<span style="color: #ff0000;">0</span>,’Label2’,<span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004017AD &nbsp;aSerial &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">7</span>,<span style="color: #ff0000;">0</span>,’Serial:’,<span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp; 004017D1 &nbsp;aLabel2_0 &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">6</span>,<span style="color: #ff0000;">0</span>,’Label2’,<span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004017DC &nbsp;aName &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">5</span>,<span style="color: #ff0000;">0</span>,’<span style="color: #0000ff;">Name</span>:’,<span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp; 004017FC &nbsp;aLabel1 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">db</span> <span style="color: #ff0000;">6</span>,<span style="color: #ff0000;">0</span>,’Label1’,<span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp; <span style="color: #ff0000;">00401807</span> &nbsp;aWhoeverTriesTh <span style="color: #0000ff;">db</span> ’’,<span style="color: #ff0000;">0</span>,’Whoever tries...</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
you can see all the components of the crackme, their data, etc etc. IconData is the raw data of the icon of the main dialog.
<br />

<br />
If we look at the source we have:~
<br />

<br />
[code=text:nmwo94j5]<div class="text" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">Begin VB.Form Form1</li><li style="" class="li2">&nbsp; BorderStyle = 3 ’Fixed Dialog</li><li style="" class="li1">&nbsp; Caption = &quot;Leimcrackme&quot;</li><li style="" class="li2">&nbsp; ClientHeight = 2940</li><li style="" class="li1">&nbsp; ClientLeft = 45</li><li style="" class="li2">&nbsp; ClientTop = 330</li><li style="" class="li1">&nbsp; ClientWidth = 4680</li><li style="" class="li2">&nbsp; Icon = &quot;andre.frx&quot;:0000</li><li style="" class="li1">&nbsp; LinkTopic = &quot;Form1&quot;</li></ol></div></td>	</tr></table><span class="postbody">
<br />

<br />
you can see the icon data is encoded in the .frx file, which usually have big data. So the Icon field links to andre.frx file and 0000 is the offset of the starting data. Infact also the last label is linked as follows:
<br />

<br />
[code=text:nmwo94j5]<div class="text" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">Caption = $&quot;andre.frx&quot;:030A</li></ol></div></td>	</tr></table><span class="postbody">
<br />

<br />
infact in the frx file after the raw icon data there is at offset 30Ah the string of that label. Of course in the compiled app all the infos (.frm and .frx) are buil in the dialog structure. In the same way you can see the infos about the second dialog (AboutDialog). Now we go and check the most important structure:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00401AA0 &nbsp;ProjectStruct <span style="color: #0000ff;">dd</span> 1F4h &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;signature?</span></li><li style="" class="li2">&nbsp;</li><li style="" class="li1">00401AA4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Tree</li><li style="" class="li2">&nbsp;00401AA8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00401AAC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;StartOfCode</li><li style="" class="li2">&nbsp;00401AB0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;EndOfCode</li><li style="" class="li1">&nbsp;00401AB4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 1238h</li><li style="" class="li2">&nbsp;00401AB8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;DataVar1</li><li style="" class="li1">&nbsp;00401ABC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;vbaExceptHandler</li><li style="" class="li2">&nbsp;00401AC0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;StartOfData</li><li style="" class="li1">&nbsp;00401AC4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> &nbsp;84h <span style="color: #0000ff;">dup</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#41;</span></li><li style="" class="li2">&nbsp;00401CD4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ExternStruct</li><li style="" class="li1">&nbsp;00401CD8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
Let's see the fields: there is a pointer to the extern imports, we already covered this structure. There are StartOfCode and EndOfCode vars, they indicate where the executable code starts and where it ends. The code is delimited by two signatures (E9E9E9E9h starting, 9E9E9E9E ending) and some 0xCC padding. There is also a field that is the pointer to the base per-thread exception handler, that is __vbaExceptHandler (but of course the code will install other handlers). There are the pointers to StartOfData and another pointer that points to StartOfData + 8, it seems these values are common for all applications. In the 84h dup(0) space you can probably find infos about path of the project etc, usually you see here some unicode strings, nothing interesting. The remaining field, Tree, is a descriptor of code modules as they were in the source (and as they are organized in the compiled exe).
<br />

<br />
So we are going to check this struct; it is a bit complex, so pay attention:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00402434</span> &nbsp;Tree <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;</li><li style="" class="li1"><span style="color: #ff0000;">00402438</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;VB_Func</li><li style="" class="li2">&nbsp;0040243C &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;TreeData</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402440</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402444</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402448</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;UnkVar1</li><li style="" class="li2">&nbsp;0040244C &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 1F1CB8D4h</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402450</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 42793AE6h</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402454</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 51A97A97h</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402458</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 41E1<span style="color: #ff0000;">033h</span></li><li style="" class="li2">&nbsp;0040245C &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">4</span><span style="color: #ff0000;">000Ah</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402460</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">4</span><span style="color: #ff0000;">0004h</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402464</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ModulesList &nbsp;<span style="color: #adadad; font-style: italic;">;ptr to ModulesList[0]</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402468</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;0040246C &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402470</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402474</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aProgetto1_0 <span style="color: #adadad; font-style: italic;">; &quot;Progetto1&quot;</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402478</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">4</span><span style="color: #ff0000;">09h</span></li><li style="" class="li2">&nbsp;0040247C &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 410h</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402480</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402484</span> &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">2</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
VB_Func is pointer to a location that is filled at runtime with some address of the vbvm, there are other fields such as the project name and an unknown var, but the interesting things are TreeData and ModuleList. Let's see TreeData:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00402DE0 &nbsp;TreeData <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00402DE4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Tree &nbsp;<span style="color: #adadad; font-style: italic;">;back pointer</span></li><li style="" class="li1">00402DE8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li2">00402DEC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402DF0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FormList</li><li style="" class="li2">00402DF4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402DF8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00402DFC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402E00 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li2">00402E04 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402E08 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ProjectInfo2</li><li style="" class="li2">00402E0C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;RawData1</li><li style="" class="li1">00402E10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;R_UnkVar1</li><li style="" class="li2">00402E14 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ProjectInfo2</li><li style="" class="li1">00402E18 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;RawData2</li><li style="" class="li2">00402E1C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;R_UnkVar2</li><li style="" class="li1">00402E20 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ProjectInfo2</li><li style="" class="li2">00402E24 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;RawData3</li><li style="" class="li1">00402E28 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;R_UnkVar3</li><li style="" class="li2">00402E2C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ProjectInfo2</li><li style="" class="li1">00402E30 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;RawData4</li><li style="" class="li2">00402E34 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;R_UnkVar4</li><li style="" class="li1">00402E38 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00402E3C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;RawData5</li><li style="" class="li1">00402E40 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;R_UnkVar5</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
what we got here? A back pointer to tree struct, some raw data and other infos about the project (you can see at projectInfo2 some data and usually you will find the string &quot;C:\Programmi\Microsoft Visual Studio\VB98\VB6.OLB&quot;), the important pointer is FormList. Let's see:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00402D18 &nbsp;FormList <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> Form<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> &nbsp;<span style="color: #adadad; font-style: italic;">;form1</span></li><li style="" class="li2">00402D1C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span> &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;module1</span></li><li style="" class="li1">00402D20 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span> &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;module2</span></li><li style="" class="li2">00402D24 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> Form<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span> &nbsp;<span style="color: #adadad; font-style: italic;">;form2</span></li></ol></div>[/asm:nmwo94j5]
<br />
infact if we see the .vbw file we find:
<br />

<br />
[code=text:nmwo94j5]<div class="text" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">Form1 = 186, 224, 986, 702, , 207, 76, 652, 524, C</li><li style="" class="li2">Module1 = 236, 214, 1036, 662,</li><li style="" class="li1">Module2 = 166, 196, 966, 644,</li><li style="" class="li2">Form2 = 100, 283, 900, 731, , 173, 118, 973, 566, C</li></ol></div></td>	</tr></table><span class="postbody">
<br />

<br />
so the FormList simply points to a list of tied dialogs to the forms/modules of the project. Note that modules correspont to .bas files, forms to .frm files (which include .frx for raw resources). Let's go on:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00402D60 Form<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00402D64 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> FormDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">00402D68 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li2">00402D6C &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402D70 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00402D74 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402D78 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FlagList</li><li style="" class="li2">00402D7C &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402D80 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;UnkData</li><li style="" class="li2">00402D84 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;UnkData</li><li style="" class="li1">00402D88 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;UnkData</li><li style="" class="li2">00402D8C &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402D90 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00402D94 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00402D98 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 58h</li><li style="" class="li2">00402D9C &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">4</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
I will not past Form[1] because its identical to Form[0]. We see some pointers to some data (mostly they point to null values), and then a pointer to FormDescriptor. Here we stop for now, we have to go back to check Tree.ModulesList structure (from there we will reach again FormDescriptor structs):
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00402488</span> ModulesList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> FormDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;0040248C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402490</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Flags_0</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402494</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402498</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;0040249C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004024A0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aForm1_0 <span style="color: #adadad; font-style: italic;">; &quot;Form1&quot;</span></li><li style="" class="li2">&nbsp;004024A4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">5</span></li><li style="" class="li1">&nbsp;004024A8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> OptionalData1</li><li style="" class="li2">&nbsp;004024AC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFh</span></li><li style="" class="li1">&nbsp;004024B0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">18</span><span style="color: #ff0000;">083h</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;Flags_1</span></li><li style="" class="li2">&nbsp;004024B4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004024B8 ModulesList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> ModuleDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;004024BC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li1">&nbsp;004024C0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Flags_1</li><li style="" class="li2">&nbsp;004024C4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004024C8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> unk_modvar1</li><li style="" class="li2">&nbsp;004024CC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004024D0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aModule1 <span style="color: #adadad; font-style: italic;">; &quot;Module1&quot;</span></li><li style="" class="li2">&nbsp;004024D4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">7</span></li><li style="" class="li1">&nbsp;004024D8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;004024DC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFh</span></li><li style="" class="li1">&nbsp;004024E0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">18</span><span style="color: #ff0000;">001h</span></li><li style="" class="li2">&nbsp;004024E4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004024E8 ModulesList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">2</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> ModuleDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;004024EC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li1">&nbsp;004024F0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Flags_1</li><li style="" class="li2">&nbsp;004024F4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004024F8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;unk_modvar2</li><li style="" class="li2">&nbsp;004024FC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402500</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aModule2 <span style="color: #adadad; font-style: italic;">; &quot;Module2&quot;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402504</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402508</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;0040250C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFh</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402510</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">18</span><span style="color: #ff0000;">001h</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402514</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402518</span> ModulesList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">3</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> FormDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;0040251C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402520</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Flags_2</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402524</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402528</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">&nbsp;0040252C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402530</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aForm2 <span style="color: #adadad; font-style: italic;">; &quot;Form2&quot;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402534</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">2</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402538</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> OptionalData2</li><li style="" class="li2">&nbsp;0040253C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFh</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00402540</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">18</span><span style="color: #ff0000;">083h</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00402544</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
voila. We can easily see names and order of the forms/modules of the project. Note that the first field is a descriptor for the Module/Form, they are different descriptors, so they have a different structure. We can go and see ModuleDescriptors:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00401938</span> ModuleDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1</span><span style="color: #ff0000;">0001h</span></li><li style="" class="li2">0040193C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Tree &nbsp;<span style="color: #adadad; font-style: italic;">;back pointer</span></li><li style="" class="li1"><span style="color: #ff0000;">00401940</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00401944</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li1"><span style="color: #ff0000;">00401948</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li2">0040194C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00401950</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> ModulesList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span> &nbsp;<span style="color: #adadad; font-style: italic;">;back pointer</span></li><li style="" class="li2"><span style="color: #ff0000;">00401954</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;MD0_UnkVar</li><li style="" class="li1"><span style="color: #ff0000;">00401958</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">0040195C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 7D63150h</li><li style="" class="li1"><span style="color: #ff0000;">00401960</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00401964</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00401968</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">0040196C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;RT_MainStruct <span style="color: #adadad; font-style: italic;">; ptr to following address</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
nothing of interest here. The other module descriptor is like this so I won't paste it. Let's see form descriptors:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00401F48 FormDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1</span></li><li style="" class="li2">00401F4C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;Tree &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;back pointer</span></li><li style="" class="li1">00401F50 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401F54 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> Form<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> &nbsp; <span style="color: #adadad; font-style: italic;">;back pointer</span></li><li style="" class="li1">00401F58 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0FFFFFFFFh</span></li><li style="" class="li2">00401F5C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00401F60 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ModulesList &nbsp;<span style="color: #adadad; font-style: italic;">;back pointer</span></li><li style="" class="li2">00401F64 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;DataVar1</li><li style="" class="li1">00401F68 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401F6C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 7D98E18h</li><li style="" class="li1">00401F70 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401F74 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00401F78 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401F7C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD0_Raw1</li><li style="" class="li1">00401F80 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1</span></li><li style="" class="li2">00401F84 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD0_Raw2</li><li style="" class="li1">00401F88 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401F8C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD0_Raw1</li><li style="" class="li1">00401F90 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1</span></li><li style="" class="li2">00401F94 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD0_ControlsList</li><li style="" class="li1">00401F98 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401F9C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD_Raw3</li><li style="" class="li1">00401FA0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">7</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;number of controls in list</span></li><li style="" class="li2">00401FA4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD0_ControlsList</li><li style="" class="li1">00401FA8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">1B</span><span style="color: #ff0000;">7</span><span style="color: #ff0000;">0005h</span></li><li style="" class="li2">00401FAC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 6C<span style="color: #ff0000;">0068h</span></li><li style="" class="li1">00401FB0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD0_Dispatcher</li><li style="" class="li2">00401FB4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD0_UnkVar1</li><li style="" class="li1">00401FB8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401FBC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 1324FCh</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
we see some unknown vars and some back pointers, what we care of is FDO_ControlsList and FDO_Dispatcher.
<br />
We see there are 7 controls in the list, so let's see the list:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00401FC8 &nbsp;FD0_ControlsList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">18</span><span style="color: #ff0000;">0040h</span> &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;control type</span></li><li style="" class="li2">00401FCC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 34h &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;ID1</span></li><li style="" class="li1">00401FD0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;RawData1</li><li style="" class="li2">00401FD4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span><span style="color: #ff0000;">0005h</span> &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;ID2</span></li><li style="" class="li1">00401FD8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401FDC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00401FE0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> LocalDispatcher<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">00401FE4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 7DC<span style="color: #ff0000;">1B</span>F0h</li><li style="" class="li1">00401FE8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aText2_0 <span style="color: #adadad; font-style: italic;">; &quot;Text2&quot;</span></li><li style="" class="li2">00401FEC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span><span style="color: #ff0000;">0005h</span></li><li style="" class="li1">00401FF0 &nbsp;FD0_ControlsList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">18</span><span style="color: #ff0000;">0040h</span> &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;control type</span></li><li style="" class="li2">00401FF4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 38h &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;ID1</span></li><li style="" class="li1">00401FF8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> RawData1</li><li style="" class="li2">00401FFC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span><span style="color: #ff0000;">0004h</span> &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;ID2</span></li><li style="" class="li1"><span style="color: #ff0000;">00402000</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00402004</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00402008</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> LocalDispatcher<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">0040200C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 7DC<span style="color: #ff0000;">1B</span>F0h</li><li style="" class="li1"><span style="color: #ff0000;">00402010</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aText1_0 <span style="color: #adadad; font-style: italic;">; &quot;Text1&quot;</span></li><li style="" class="li2"><span style="color: #ff0000;">00402014</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span><span style="color: #ff0000;">0004h</span></li><li style="" class="li1">etc...</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
we have all the components of the dialog, which is fundamental in event tracking. You can see names for the controls, some strange values (ID1 and ID2, seems like they are internally used as resource id) and LocalDispatcher. This is the point of all! LocalDispatcher infact points to a structure that contains all event handlers of the controls! Let's see LocalDispatcher[0]:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">004020F4 LocalDispatcher<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">004020F8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FD0_ControlsList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">004020FC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> FormDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2"><span style="color: #ff0000;">00402100</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_QueryInterface</li><li style="" class="li1"><span style="color: #ff0000;">00402104</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_AddRef</li><li style="" class="li2"><span style="color: #ff0000;">00402108</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_Release</li><li style="" class="li1">0040210C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 18h <span style="color: #0000ff;">dup</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#41;</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
the first field is always zero. The second is a backpointer to the parent structure in the controls list, the third is a backpointer to parent FormDescriptor structure. After we find some basic handlers which are present in all controls, then we have no other handlers. This is the dispatcher of a &quot;label&quot; control, so it has no other handlers!
<br />

<br />
So we can choose another control in the list:
<br />

<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00402040</span> ControlsList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">3</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">11</span><span style="color: #ff0000;">0040h</span></li><li style="" class="li2"><span style="color: #ff0000;">00402044</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 40h</li><li style="" class="li1"><span style="color: #ff0000;">00402048</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;RawData3</li><li style="" class="li2">0040204C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span><span style="color: #ff0000;">0002h</span></li><li style="" class="li1"><span style="color: #ff0000;">00402050</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00402054</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00402058</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> LocalDispatcher<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">3</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">0040205C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> 7DC1C10h</li><li style="" class="li1"><span style="color: #ff0000;">00402060</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;aCommand1_0 <span style="color: #adadad; font-style: italic;">; &quot;Command1&quot;</span></li><li style="" class="li2"><span style="color: #ff0000;">00402064</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">3</span><span style="color: #ff0000;">0002h</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
as before we go and see the LocalDispatcher[3]:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00402278</span> LocalDispatcher<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">3</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">0040227C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;ControlsList_3_</li><li style="" class="li1"><span style="color: #ff0000;">00402280</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FormDescriptor_0_</li><li style="" class="li2"><span style="color: #ff0000;">00402284</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_QueryInterface</li><li style="" class="li1"><span style="color: #ff0000;">00402288</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_AddRef</li><li style="" class="li2">0040228C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_Release</li><li style="" class="li1"><span style="color: #ff0000;">00402290</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> onClickAbout</li><li style="" class="li2">&nbsp;</li><li style="" class="li1"><span style="color: #ff0000;">00402294</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> 10h <span style="color: #0000ff;">dup</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#41;</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
voila, what we were searching for! We have the onClickAbout pointer, that points to:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">004023FD onClickAbout&amp;#<span style="color: #ff0000;">058</span><span style="color: #adadad; font-style: italic;">;</span></li><li style="" class="li2">004023FD &nbsp; &nbsp; <span style="color: #00007f;">sub</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>esp<span style="color: #ff0000;">+4</span><span style="color: #66cc66;">&#93;</span>, 3Fh</li><li style="" class="li1"><span style="color: #ff0000;">00402405</span> onClickAbout1:</li><li style="" class="li2"><span style="color: #ff0000;">00402405</span> &nbsp; &nbsp; <span style="color: #00007f;">jmp</span> onClickAboutRoutine</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
that is a transfer area (internal function dispatcher) for local event handlers, So now we know what routine is executed when &quot;About&quot; button is pressed. The problem is, how did I know that is a onClick handler? It could be a onOver, onMove etc etc? To answer this question let's see the Label1 dispatcher, we know that is has a onOver handler, we can see it at runtime (and we know it is label1 from line 004017FC remember?)
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00402330</span> LocalDispatcher<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">5</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00402334</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> ControlsList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">5</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1"><span style="color: #ff0000;">00402338</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> FormDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">0040233C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_QueryInterface</li><li style="" class="li1"><span style="color: #ff0000;">00402340</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_AddRef</li><li style="" class="li2"><span style="color: #ff0000;">00402344</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_Release</li><li style="" class="li1"><span style="color: #ff0000;">00402348</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">0040234C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00402350</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00402354</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00402358</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">0040235C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00402360</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2"><span style="color: #ff0000;">00402364</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1"><span style="color: #ff0000;">00402368</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">0040236C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> onOverLabel1</li><li style="" class="li1"><span style="color: #ff0000;">00402370</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">8</span> <span style="color: #0000ff;">dup</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#41;</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
we see the common handler and backpointers, then far away the onOver handler pointer. So my idea is that every field of the LocalDispatch structure is a pointer to a given event handler (00402348 would be onClick etc), in addition the LocalDispatch structure seems to be not exactly the same for all control types, so if you want to map all controls handlers you should write an app which uses all possible handlers and see where they are placed in this struct. Now we can go back to FormDescriptor[0] and check the last pointer, that was FD0Dispatcher, it points to
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">004020E0 &nbsp;FD0_Dispatcher <span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;onClickAboutPre1</li><li style="" class="li2">004020E4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;onClickAbout1</li><li style="" class="li1">004020E8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;onClickCheck1</li><li style="" class="li2">004020EC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;OnOverForm1</li><li style="" class="li1">004020F0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;onOverLabel11</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
a simple list to all import transfers addresses (they point directly to the jumps, the pointers in local dispatchers instead point to previous line!). As for this form, we can go in ModulesList[3] and check FormDescriptor[1], we will find the controls list and associated event handlers.
<br />

<br />
In particular, in this form there is a moving button, if we check the LocalDispatcher of this button we see:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">00401E70 FD1_LocalDispatcher<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span> <span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401E74 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> FD1_ControlsList<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">1</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">00401E78 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;FormDescriptor_1_</li><li style="" class="li2">00401E7C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_QueryInterface</li><li style="" class="li1">00401E80 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_AddRef</li><li style="" class="li2">00401E84 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> &nbsp;i_EVENT_SINK_Release</li><li style="" class="li1">00401E88 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> onClickOk</li><li style="" class="li2">00401E8C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00401E90 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401E94 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00401E98 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401E9C &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00401EA0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401EA4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li1">00401EA8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">0</span></li><li style="" class="li2">00401EAC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #0000ff;">offset</span> onOverOk</li><li style="" class="li1">00401EB0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">dd</span> <span style="color: #ff0000;">7</span> <span style="color: #0000ff;">dup</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#41;</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
the other controls in the list just have default handlers.
<br />

<br />
We have mapped all the resource and relative event handlers just by examining data structures (and using a bit of zen!).
<br />

<br />
Now we can work on the code. Let's say we want to find a correct serial for a given name. We know that the routine called when the Check button is pressed is at address 00402FD0, so we start from there:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #adadad; font-style: italic;">;standard function initialization</span></li><li style="" class="li2">&nbsp;00402FD0 &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ebp</span> &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;allocate private stackframe</span></li><li style="" class="li1">&nbsp;00402FD1 &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ebp</span>, <span style="color: #46aa03; font-weight:bold;">esp</span></li><li style="" class="li2">&nbsp;00402FD3 &nbsp;<span style="color: #00007f;">sub</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, <span style="color: #ff0000;">0Ch</span></li><li style="" class="li1">&nbsp;00402FD6 &nbsp;<span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> vbaExceptHandler &nbsp;<span style="color: #adadad; font-style: italic;">;installing default seh</span></li><li style="" class="li2">&nbsp;00402FDB &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #0000ff;">large</span> <span style="color: #46aa03; font-weight:bold;">fs</span>:<span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;00402FE1 &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;00402FE2 &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #0000ff;">large</span> <span style="color: #46aa03; font-weight:bold;">fs</span>:<span style="color: #ff0000;">0</span>, <span style="color: #46aa03; font-weight:bold;">esp</span></li><li style="" class="li1">&nbsp;00402FE9 &nbsp;<span style="color: #00007f;">sub</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, 74h</li><li style="" class="li2">&nbsp;00402FEC &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ebx</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;save registers area</span></li><li style="" class="li1">&nbsp;00402FED &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">esi</span> </li><li style="" class="li2">&nbsp;00402FEE &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;loading destructors</span></li><li style="" class="li1">&nbsp;00402FEF &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-<span style="color: #ff0000;">0Ch</span><span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esp</span></li><li style="" class="li2">&nbsp;00402FF2 &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>pDestruct<span style="color: #66cc66;">&#93;</span>, <span style="color: #0000ff;">offset</span> Destructors_2</li><li style="" class="li1">&nbsp;</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;allocating dynamic resource</span></li><li style="" class="li1">&nbsp;00402FF9 &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">esi</span>, <span style="color: #66cc66;">&#91;</span>ebp<span style="color: #ff0000;">+8</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;00402FFC &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li1">&nbsp;00402FFE &nbsp;<span style="color: #00007f;">and</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #ff0000;">1</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403001</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp<span style="color: #ff0000;">-4</span><span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403004</span> &nbsp;<span style="color: #00007f;">and</span> <span style="color: #46aa03; font-weight:bold;">esi</span>, <span style="color: #ff0000;">0FFFFFFFEh</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403007</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403008</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp<span style="color: #ff0000;">+8</span><span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403</span><span style="color: #ff0000;">00B</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">esi</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;0040300D &nbsp;<span style="color: #00007f;">call</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>ecx<span style="color: #ff0000;">+4</span><span style="color: #66cc66;">&#93;</span> <span style="color: #adadad; font-style: italic;">; &nbsp;Zombie_AddRef</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
the parent object (the form) is passed as parameter (ebp+8, sorry I forgot to resolve ebp based frame function in ida!) and the COM tecnology uses AddRef to increment reference count of the object (instantiation). For those of you that don't know this, COM objects are responsible for their lifetime, the resources they use are allocated until the reference count is 0, when it reached 0 the objects enter zombie state and can be deallocated to free resources (well, things are a little more complex, see COM object management documentation to know more on this topic).
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #adadad; font-style: italic;">;background color changing</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403010</span> &nbsp;<span style="color: #00007f;">xor</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403012</span> &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span>ebp-24h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403015</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ebx</span>, <span style="color: #ff0000;">8</span><span style="color: #ff0000;">0020004h</span></li><li style="" class="li1">&nbsp;0040301A &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">edi</span>, <span style="color: #ff0000;">0Ah</span></li><li style="" class="li2">&nbsp;0040301F &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-24h<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; <span style="color: #adadad; font-style: italic;">;zero vars</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403022</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403023</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-34h<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403026</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-44h<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403029</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-1Ch<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">ebx</span></li><li style="" class="li1">&nbsp;0040302C &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-24h<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;0040302F &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:rtcRandomNext &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;get random fp values</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403035</span> &nbsp;<span style="color: #0000ff;">fstp</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>COlor_R<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403038</span> &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp-34h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;0040303B &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-2Ch<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">ebx</span></li><li style="" class="li2">&nbsp;0040303E &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;0040303F &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-34h<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403042</span> &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:rtcRandomNext</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403048</span> &nbsp;<span style="color: #0000ff;">fstp</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>Color_G<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;0040304B &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-44h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;0040304E &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-3Ch<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">ebx</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403051</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ebx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">esi</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403053</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403054</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>ebp-44h<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403057</span> &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:rtcRandomNext &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;color_B not stored, used directly eax</span></li><li style="" class="li2">&nbsp;0040305D &nbsp;<span style="color: #0000ff;">fmul</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:_0255 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;multiply each rand fpu * 255</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403063</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">edi</span>, <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaR8IntI2</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403069</span> &nbsp;<span style="color: #0000ff;">fnstsw</span> <span style="color: #46aa03; font-weight:bold;">ax</span></li><li style="" class="li1">&nbsp;0040306B &nbsp;<span style="color: #00007f;">test</span> <span style="color: #46aa03; font-weight:bold;">al</span>, <span style="color: #ff0000;">0Dh</span></li><li style="" class="li2">&nbsp;0040306D &nbsp;<span style="color: #00007f;">jnz</span> loc_40312F &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;fpexception</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403073</span> &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">edi</span> <span style="color: #adadad; font-style: italic;">; &nbsp;__vbaR8IntI2 &nbsp;;cast from _fpu real 8 bytes_ to _integer 2 bytes_</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403075</span> &nbsp;<span style="color: #0000ff;">fld</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>ebp-7Ch<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403078</span> &nbsp;<span style="color: #0000ff;">fmul</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:_0255</li><li style="" class="li2">&nbsp;0040307E &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;0040307F &nbsp;<span style="color: #0000ff;">fnstsw</span> <span style="color: #46aa03; font-weight:bold;">ax</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403081</span> &nbsp;<span style="color: #00007f;">test</span> <span style="color: #46aa03; font-weight:bold;">al</span>, <span style="color: #ff0000;">0Dh</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403083</span> &nbsp;<span style="color: #00007f;">jnz</span> loc_40312F &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;fpexception</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403089</span> &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">edi</span> <span style="color: #adadad; font-style: italic;">; &nbsp;__vbaR8IntI2</span></li><li style="" class="li1">&nbsp;0040308B &nbsp;<span style="color: #0000ff;">fld</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>ebp-78h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;0040308E &nbsp;<span style="color: #0000ff;">fmul</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:_0255</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403094</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403095</span> &nbsp;<span style="color: #0000ff;">fnstsw</span> <span style="color: #46aa03; font-weight:bold;">ax</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403097</span> &nbsp;<span style="color: #00007f;">test</span> <span style="color: #46aa03; font-weight:bold;">al</span>, <span style="color: #ff0000;">0Dh</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403099</span> &nbsp;<span style="color: #00007f;">jnz</span> loc_40312F &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;fpexception</span></li><li style="" class="li1">&nbsp;0040309F &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">edi</span> <span style="color: #adadad; font-style: italic;">; &nbsp;__vbaR8IntI2</span></li><li style="" class="li2">&nbsp;004030A1 &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;004030A2 &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:rtcRgb</li><li style="" class="li2">&nbsp;004030A8 &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;rgb resulting from previous calculus</span></li><li style="" class="li1">&nbsp;004030A9 &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">esi</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;form object instance</span></li><li style="" class="li2">&nbsp;004030AA &nbsp;<span style="color: #00007f;">call</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebx</span>+64h<span style="color: #66cc66;">&#93;</span> <span style="color: #adadad; font-style: italic;">; &nbsp;MSVBVM_UnkFunc2 (Set back form color)</span></li><li style="" class="li1">&nbsp;004030AD &nbsp;<span style="color: #00007f;">test</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;004030AF &nbsp;<span style="color: #0000ff;">fnclex</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403</span><span style="color: #ff0000;">0B</span><span style="color: #ff0000;">1</span> &nbsp;<span style="color: #00007f;">jge</span> <span style="color: #0000ff;">short</span> &nbsp;loc_4030C2 &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;taken</span></li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403</span><span style="color: #ff0000;">0B</span><span style="color: #ff0000;">3</span> &nbsp;<span style="color: #00007f;">push</span> 64h</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403</span><span style="color: #ff0000;">0B</span><span style="color: #ff0000;">5</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> dword_402590</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403</span><span style="color: #ff0000;">0B</span>A &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403</span><span style="color: #ff0000;">0B</span>B &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403</span><span style="color: #ff0000;">0B</span>C &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaHresultCheckObj</li><li style="" class="li2">&nbsp;</li><li style="" class="li1">&nbsp;004030C2 &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span>ebp-44h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;004030C5 &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp-34h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004030C8 &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li2">&nbsp;004030C9 &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-24h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004030CC &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;004030CD &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li1">&nbsp;004030CE &nbsp;<span style="color: #00007f;">push</span> <span style="color: #ff0000;">3</span> &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;number of objects</span></li><li style="" class="li2">&nbsp;004030D0 &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeVarList &nbsp; <span style="color: #adadad; font-style: italic;">;free vars used in previous rtcRandomNext</span></li><li style="" class="li1">&nbsp;</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;name/serial check</span></li><li style="" class="li1">&nbsp;004030D6 &nbsp;<span style="color: #00007f;">add</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, 10h</li><li style="" class="li2">&nbsp;004030D9 &nbsp;<span style="color: #00007f;">call</span> &nbsp;VoidCheck</li><li style="" class="li1">&nbsp;004030DE &nbsp;<span style="color: #00007f;">test</span> <span style="color: #46aa03; font-weight:bold;">ax</span>, <span style="color: #46aa03; font-weight:bold;">ax</span></li><li style="" class="li2">&nbsp;004030E1 &nbsp;<span style="color: #00007f;">jnz</span> <span style="color: #0000ff;">short</span> &nbsp;loc_4030E8</li><li style="" class="li1">&nbsp;004030E3 &nbsp;<span style="color: #00007f;">call</span> SerialValidation</li><li style="" class="li2">&nbsp;004030E8 &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>ebp<span style="color: #ff0000;">-4</span><span style="color: #66cc66;">&#93;</span>, <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004030EF &nbsp;Destr_2_0:</li><li style="" class="li2">&nbsp;004030EF &nbsp;<span style="color: #00007f;">wait</span></li><li style="" class="li1">&nbsp;004030F0 &nbsp;<span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> &nbsp;loc_403110</li><li style="" class="li2">&nbsp;004030F5 &nbsp;<span style="color: #00007f;">jmp</span> <span style="color: #0000ff;">short</span> EndRoutine</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
SerialValidation is the routine that checks the serial, so we will check it (see later). VoidCheck is the routine that checks if text fields are void, if so display the error message then exit.
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">&nbsp;</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;destructors and ending stuff</span></li><li style="" class="li1">&nbsp;004030F7 &nbsp;Destr_2_1: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;called in case of error</span></li><li style="" class="li2">&nbsp;004030F7 &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span>ebp-44h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004030FA &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp-34h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;004030FD &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li1">&nbsp;004030FE &nbsp;<span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-24h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403101</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403102</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403103</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #ff0000;">3</span> &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;number of vars to free</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403105</span> &nbsp;<span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeVarList</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403</span><span style="color: #ff0000;">10B</span> &nbsp;<span style="color: #00007f;">add</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, 10h</li><li style="" class="li1">&nbsp;0040310E &nbsp;<span style="color: #00007f;">retn</span></li><li style="" class="li2">&nbsp;0040310F &nbsp;EndRoutine</li><li style="" class="li1">&nbsp;0040310F &nbsp;<span style="color: #00007f;">retn</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;goes to 00403110</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403110</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp<span style="color: #ff0000;">+8</span><span style="color: #66cc66;">&#93;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;ptr to form object</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403113</span> &nbsp;<span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403114</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">eax</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403116</span> &nbsp;<span style="color: #00007f;">call</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>edx<span style="color: #ff0000;">+8</span><span style="color: #66cc66;">&#93;</span> &nbsp; <span style="color: #adadad; font-style: italic;">;Zombie_Release (decrease reference count</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403119</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp<span style="color: #ff0000;">-4</span><span style="color: #66cc66;">&#93;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;for form object)</span></li><li style="" class="li1">&nbsp;0040311C &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-14h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;0040311F &nbsp;<span style="color: #00007f;">pop</span> <span style="color: #46aa03; font-weight:bold;">edi</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;save registers area</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403120</span> &nbsp;<span style="color: #00007f;">pop</span> <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403121</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #0000ff;">large</span> <span style="color: #46aa03; font-weight:bold;">fs</span>:<span style="color: #ff0000;">0</span>, <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;restore exception handler</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403128</span> &nbsp;<span style="color: #00007f;">pop</span> <span style="color: #46aa03; font-weight:bold;">ebx</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403129</span> &nbsp;<span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, <span style="color: #46aa03; font-weight:bold;">ebp</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;delete private stackframe</span></li><li style="" class="li1">&nbsp;0040312B &nbsp;<span style="color: #00007f;">pop</span> <span style="color: #46aa03; font-weight:bold;">ebp</span></li><li style="" class="li2">&nbsp;0040312C &nbsp;<span style="color: #00007f;">retn</span> <span style="color: #ff0000;">4</span></li><li style="" class="li1">&nbsp;</li><li style="" class="li2">&nbsp;0040312F &nbsp;<span style="color: #00007f;">jmp</span> loc_4011AC &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">; __vbaFPException</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
are you beginning to feel the VB framework? It's really easy as you can see, the structure of the code is always the same.
<br />

<br />
Again let's see all the code, so you can understand how easy is code analisys:
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">SerialValidation</li><li style="" class="li2">&nbsp;004032C0 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ebp</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;allocate private stackframe</span></li><li style="" class="li1">&nbsp;004032C1 <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ebp</span>, <span style="color: #46aa03; font-weight:bold;">esp</span></li><li style="" class="li2">&nbsp;004032C3 <span style="color: #00007f;">sub</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, <span style="color: #ff0000;">8</span></li><li style="" class="li1">&nbsp;004032C6 <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> &nbsp;vbaExceptHandler &nbsp;<span style="color: #adadad; font-style: italic;">;allocate exception handler</span></li><li style="" class="li2">&nbsp;004032CB <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #0000ff;">large</span> <span style="color: #46aa03; font-weight:bold;">fs</span>:<span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004032D1 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;004032D2 <span style="color: #00007f;">mov</span> <span style="color: #0000ff;">large</span> <span style="color: #46aa03; font-weight:bold;">fs</span>:<span style="color: #ff0000;">0</span>, <span style="color: #46aa03; font-weight:bold;">esp</span></li><li style="" class="li1">&nbsp;004032D9 <span style="color: #00007f;">sub</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, 158h</li><li style="" class="li2">&nbsp;004032DF <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ebx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;registers save area</span></li><li style="" class="li1">&nbsp;004032E0 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li2">&nbsp;004032E1 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;destructors allocation and initialization</span></li><li style="" class="li1">&nbsp;004032E2 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_8<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esp</span></li><li style="" class="li2">&nbsp;004032E5 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_4<span style="color: #66cc66;">&#93;</span>, <span style="color: #0000ff;">offset</span> Destructors_5</li><li style="" class="li1">&nbsp;004032EC <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, Form1Instance</li><li style="" class="li2">&nbsp;004032F1 <span style="color: #00007f;">xor</span> <span style="color: #46aa03; font-weight:bold;">edi</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;004032F3 <span style="color: #00007f;">cmp</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #46aa03; font-weight:bold;">edi</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;is form1 instanced?</span></li><li style="" class="li2">&nbsp;004032F5 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_20<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span> &nbsp; <span style="color: #adadad; font-style: italic;">;zero vars</span></li><li style="" class="li1">&nbsp;004032F8 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_30<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;004032FB <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_40<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;004032FE <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_50<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403301</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_54<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403304</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_58<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403307</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_5C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;0040330A <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_6C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;0040330D <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_7C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403310</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_8C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403316</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_9C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;0040331C <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_AC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403322</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_BC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403328</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_CC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;0040332E <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_DC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403334</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_EC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;0040333A <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_FC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403340</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_10C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403346</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_11C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;0040334C <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_13C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403352</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_14C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403358</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_15C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li2">&nbsp;0040335E <span style="color: #00007f;">jnz</span> <span style="color: #0000ff;">short</span> &nbsp;loc_403375 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;jump if form1 istanced</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403360</span> <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> Form1Instance</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403365</span> <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> FormDescriptor_0_</li><li style="" class="li1">&nbsp;0040336A <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaNew2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;if not instanced the form wuold</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403370</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, Form1Instance &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;have been created here</span></li><li style="" class="li1">&nbsp;</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;copy vars from form instance to local vars</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403375</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">eax</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403377</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;form object instance</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403378</span> <span style="color: #00007f;">call</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>ecx<span style="color: #ff0000;">+3</span><span style="color: #ff0000;">08h</span><span style="color: #66cc66;">&#93;</span> <span style="color: #adadad; font-style: italic;">;MSVBVM_UnkFunc (some sort of addref)</span></li><li style="" class="li2">&nbsp;0040337E <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">esi</span>, <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarMove</li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403384</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ebx</span>, <span style="color: #ff0000;">9</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403389</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_6C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;0040338C <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+Text1<span style="color: #66cc66;">&#93;</span> &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;note, text1 object, not string!</span></li><li style="" class="li2">&nbsp;0040338F <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_64<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;(parameter in ecx, fastcall style)</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403392</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_6C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">ebx</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403395</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">esi</span> <span style="color: #adadad; font-style: italic;">; &nbsp;__vbaVarMove &nbsp; ;copy text1 in local var</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403397</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, Form1Instance</li><li style="" class="li2">&nbsp;0040339C <span style="color: #00007f;">cmp</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;0040339E <span style="color: #00007f;">jnz</span> <span style="color: #0000ff;">short</span> loc_4033B5 &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;avoid allocation of form if it exists</span></li><li style="" class="li2">&nbsp;004033A0 <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> Form1Instance</li><li style="" class="li1">&nbsp;004033A5 <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> FormDescriptor_0_</li><li style="" class="li2">&nbsp;004033AA <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaNew2</li><li style="" class="li1">&nbsp;004033B0 <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, Form1Instance</li><li style="" class="li2">&nbsp;004033B5 <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">eax</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004033B7 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;004033B8 <span style="color: #00007f;">call</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>edx<span style="color: #ff0000;">+3</span><span style="color: #ff0000;">0Ch</span><span style="color: #66cc66;">&#93;</span> <span style="color: #adadad; font-style: italic;">; MSVBVM_UnkFunc (as above)</span></li><li style="" class="li1">&nbsp;004033BE <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_6C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;004033C1 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+Text2<span style="color: #66cc66;">&#93;</span> &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;note, text2 object, not string!</span></li><li style="" class="li1">&nbsp;004033C4 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_64<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;(parameter in ecx, fastcall style)</span></li><li style="" class="li2">&nbsp;004033C7 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_6C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">ebx</span></li><li style="" class="li1">&nbsp;004033CA <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">esi</span> <span style="color: #adadad; font-style: italic;">; &nbsp;__vbaVarMove &nbsp; ;copy text2 in local var</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
as you can see COM tecnology strikes again: in the form object there is the list of controls, each one with his own data (text controls have a simple string). So what does the code do? It simply copies the data from those object in loval variables (Text1 and Text2), it uses __vbaVarMove to copy data. Attention: it does not copy only the string, but the whole text object! The paramenter is passed via ecx register (fastcall) convention), and is a pointer to the memory space that receives object data. So if you want to know the data of the object (the text in this case), after __vbaVarMove go to data pointed by Text1 (ebp-50h), and see the third dword: it is a pointer to the unicode string for name inserted. So the structure should be as follows:
<br />

<br />
[code]RT_Text_Object:
<br />
 +00 SizeOf(RT_Text_Object)
<br />
 +04 Method1
<br />
 +08 TextPointer
<br />
 +0C etc (other values or methods)[/code]
<br />

<br />
ok, we now know that the proggy has copied locally the data of text objects, we also know the addresses of this objects, so we can easily track all movements on these strings.
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #adadad; font-style: italic;">;check length of name</span></li><li style="" class="li2">&nbsp;004033CC <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #ff0000;">1</span></li><li style="" class="li1">&nbsp;004033D1 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+Text1<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;004033D4 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_104<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;004033DA <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_F4<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;004033E0 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_10C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004033E6 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_6C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;004033E9 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;004033EA <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">esi</span>, <span style="color: #ff0000;">2</span></li><li style="" class="li2">&nbsp;004033EF <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;object (Text1)</span></li><li style="" class="li1">&nbsp;004033F0 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;var object that receives length</span></li><li style="" class="li2">&nbsp;004033F1 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_10C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li1">&nbsp;004033F7 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_FC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li2">&nbsp;004033FD <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_114<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edi</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403403</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_11C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403409</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaLenVar &nbsp; <span style="color: #adadad; font-style: italic;">;get length of text1 (name)</span></li><li style="" class="li1">&nbsp;0040340F <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;var object for target value of subtraction</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403410</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_FC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403416</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_7C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403419</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;var object for value to subtract (1)</span></li><li style="" class="li1">&nbsp;0040341A <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;var object for result of subtraction</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">004034</span><span style="color: #ff0000;">1B</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarSub</li></ol></div>[/asm:nmwo94j5]
<br />

<br />
some easy function here, the first function gets the Text1 and gets its length. As before keep in mind that the pointers points to OBJECTS, so vbaLenVar does not return the length of the string, but the object that contains the length. The object is as before:
<br />

<br />
[code=text:nmwo94j5]<div class="text" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">RT_Var_Object:</li><li style="" class="li2">&nbsp;+00 SizeOf(RT_Text_Object)</li><li style="" class="li1">&nbsp;+04 Method1</li><li style="" class="li2">&nbsp;+08 Data (length of string)</li><li style="" class="li1">&nbsp;+0C etc (other values or methods)</li></ol></div></td>	</tr></table><span class="postbody">
<br />

<br />
so you must look the third dword at the memory pointed by the result pointer of vbaLenVar. Same thing for all other __vba***. So here it gets length of string and decrements it by one.
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #adadad; font-style: italic;">;main for() cycle</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403421</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;(strlen(Text1)-1) object</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403422</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_11C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403428</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_15C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;0040342E <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li2">&nbsp;0040342F <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_14C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403435</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403436</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span>counter<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403439</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li2">&nbsp;0040343A <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;counter</span></li><li style="" class="li1">&nbsp;</li><li style="" class="li2">&nbsp;0040343B <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarForInit <span style="color: #adadad; font-style: italic;">;prepare for() cycle</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403441</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">edi</span>, <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarMul</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403447</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ebx</span>, <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarAdd</li><li style="" class="li1">&nbsp;</li><li style="" class="li2"><span style="color: #adadad; font-style: italic;">;loop here</span></li><li style="" class="li1">&nbsp;0040344D <span style="color: #00007f;">test</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;is cycle finished? (true = loop, false = exit)</span></li><li style="" class="li2">&nbsp;0040344F <span style="color: #00007f;">jz</span> EndCheck &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;then check ends</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403455</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, Form1Instance</li><li style="" class="li2">&nbsp;0040345A <span style="color: #00007f;">test</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;0040345C <span style="color: #00007f;">jnz</span> <span style="color: #0000ff;">short</span> loc_403473 &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;is form1 instanced?</span></li><li style="" class="li2">&nbsp;0040345E <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> Form1Instance &nbsp;<span style="color: #adadad; font-style: italic;">;create instance if not</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403463</span> <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> FormDescriptor<span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">0</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403468</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaNew2</li><li style="" class="li1">&nbsp;0040346E <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, Form1Instance</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403473</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">eax</span><span style="color: #66cc66;">&#93;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;use current instance</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403475</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;form1 instance</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403476</span> <span style="color: #00007f;">call</span> <span style="color: #0000ff;">dword</span> <span style="color: #0000ff;">ptr</span> <span style="color: #66cc66;">&#91;</span>ecx<span style="color: #ff0000;">+3</span><span style="color: #ff0000;">08h</span><span style="color: #66cc66;">&#93;</span> &nbsp; <span style="color: #adadad; font-style: italic;">;MSVBVM_UnkFunc</span></li><li style="" class="li1">&nbsp;0040347C <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_5C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;0040347F <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403480</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403481</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaObjSet &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;set object var to [ebp+var_5C] ptr</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403487</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #ff0000;">1</span></li><li style="" class="li2">&nbsp;0040348C <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>counter<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;0040348F <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_F4<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;set vars to true</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403495</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_A4<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">&nbsp;0040349B <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_114<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;004034A1 <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_5C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004034A4 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_94<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">&nbsp;004034AA <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_AC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004034B0 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;value to add (1)</span></li><li style="" class="li2">&nbsp;004034B1 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_11C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004034B7 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;target value of addiction (counter)</span></li><li style="" class="li2">&nbsp;004034B8 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_8C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;004034BE <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;value to add</span></li><li style="" class="li2">&nbsp;004034BF <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;target</span></li><li style="" class="li1">&nbsp;004034C0 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_104<span style="color: #66cc66;">&#93;</span>, 64h</li><li style="" class="li2">&nbsp;004034CA <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_10C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li1">&nbsp;004034D0 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_FC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li2">&nbsp;004034D6 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_AC<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li1">&nbsp;004034DC <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_11C<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li2">&nbsp;004034E2 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_5C<span style="color: #66cc66;">&#93;</span>, <span style="color: #ff0000;">0</span></li><li style="" class="li1">&nbsp;004034E9 <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_9C<span style="color: #66cc66;">&#93;</span>, <span style="color: #ff0000;">9</span></li><li style="" class="li2">&nbsp;004034F3 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ebx</span> <span style="color: #adadad; font-style: italic;">; __vbaVarAdd</span></li><li style="" class="li1">&nbsp;004034F5 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;result object</span></li><li style="" class="li2">&nbsp;004034F6 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaI4Var &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;convert result object to int_4_bytes</span></li><li style="" class="li1">&nbsp;004034FC <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_9C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403502</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;position</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403503</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_BC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403509</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;length</span></li><li style="" class="li1">&nbsp;0040350A <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;target string (name)</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">004035</span><span style="color: #ff0000;">0B</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:rtcMidCharVar &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;extract one char from name at counter+1 position</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403511</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_BC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403517</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_54<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">&nbsp;0040351A <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;extracted char object</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">004035</span><span style="color: #ff0000;">1B</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;name string</span></li><li style="" class="li1">&nbsp;0040351C <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaStrVarVal</li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403522</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;extracted char value</span></li><li style="" class="li1">&nbsp;<span style="color: #ff0000;">00403523</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:rtcAnsiValueBstr &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;get ansi value from extracted value</span></li><li style="" class="li2">&nbsp;<span style="color: #ff0000;">00403529</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;ansi string of value of mid</span></li><li style="" class="li1">&nbsp;0040352A <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaStrI2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;convert it to int_2_bytes</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
this code increments the for() counter and gets the char at counter+1 position with mid function. Then it obtains the numeric value of the extracted char, then at the end it converts it into a unicode string representing that char in decimal number. Example: at iteration x it extracts Name[x+1] char, let's assume it is an A (0x41). Then it gets the numeric value (0x41) and then the unicode string 65 (dec for 0x41), unicode means the string will be (0x36 x0xx 0x35 0x00).
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00403530</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2"><span style="color: #ff0000;">00403532</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_58<span style="color: #66cc66;">&#93;</span> &nbsp;<span style="color: #adadad; font-style: italic;">;ptr to unicode int2bytes</span></li><li style="" class="li1"><span style="color: #ff0000;">00403535</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaStrMove &nbsp; <span style="color: #adadad; font-style: italic;">;move unicode decimal number in ebp+var48</span></li><li style="" class="li2">0040353B <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;unicode decimal number</span></li><li style="" class="li1">0040353C <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:rtcR8ValFromBstr &nbsp;<span style="color: #adadad; font-style: italic;">;convert unicode decimal number string</span></li><li style="" class="li2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;in floating point value</span></li><li style="" class="li1"><span style="color: #ff0000;">00403542</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFpI4 &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;convert previous fp number in int4bytes</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
here we have the numeric value of the extracted char in eax
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1"><span style="color: #ff0000;">00403548</span> <span style="color: #00007f;">cdq</span></li><li style="" class="li2"><span style="color: #ff0000;">00403549</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #ff0000;">0Ah</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;divisor</span></li><li style="" class="li1">0040354E <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_13C<span style="color: #66cc66;">&#93;</span>, <span style="color: #ff0000;">3</span></li><li style="" class="li2"><span style="color: #ff0000;">00403558</span> <span style="color: #00007f;">idiv</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;int4bytes % 10</span></li><li style="" class="li1">0040355A <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_10C<span style="color: #66cc66;">&#93;</span> &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;trash result</span></li><li style="" class="li2"><span style="color: #ff0000;">00403560</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>counter<span style="color: #66cc66;">&#93;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;trash divisor</span></li><li style="" class="li1"><span style="color: #ff0000;">00403563</span> <span style="color: #00007f;">mov</span> <span style="color: #66cc66;">&#91;</span>rest<span style="color: #66cc66;">&#93;</span>, <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;save rest of division</span></li><li style="" class="li2"><span style="color: #ff0000;">00403569</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_40<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">0040356C <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;result string</span></li><li style="" class="li2">0040356D <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;value 100 (for multiplication)</span></li><li style="" class="li1">0040356E <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_FC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2"><span style="color: #ff0000;">00403574</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;target (counter)</span></li><li style="" class="li1"><span style="color: #ff0000;">00403575</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>total<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2"><span style="color: #ff0000;">00403578</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;value to add (1)</span></li><li style="" class="li1"><span style="color: #ff0000;">00403579</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;target (result)</span></li><li style="" class="li2">0040357A <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ebx</span> <span style="color: #adadad; font-style: italic;">; __vbaVarAdd &nbsp; &nbsp;;increment counter</span></li><li style="" class="li1">0040357C <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_7C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">0040357F <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1"><span style="color: #ff0000;">00403580</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li2"><span style="color: #ff0000;">00403581</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">edi</span> <span style="color: #adadad; font-style: italic;">; __vbaVarMul &nbsp; &nbsp;;100 * (counter+1)</span></li><li style="" class="li1"><span style="color: #ff0000;">00403583</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2"><span style="color: #ff0000;">00403584</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_13C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">0040358A <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_CC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2"><span style="color: #ff0000;">00403590</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li1"><span style="color: #ff0000;">00403591</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2"><span style="color: #ff0000;">00403592</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">edi</span> <span style="color: #adadad; font-style: italic;">; __vbaVarMul &nbsp; &nbsp;;(100*(counter+1)) * previous calculus</span></li><li style="" class="li1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;on extracted char</span></li><li style="" class="li2"><span style="color: #ff0000;">00403594</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_DC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">0040359A <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">0040359B <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li1">0040359C <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarInt &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;cast to int the result of all calculus</span></li><li style="" class="li2">004035A2 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_EC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">004035A8 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;int numeric value</span></li><li style="" class="li2">004035A9 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;string that gets total</span></li><li style="" class="li1">004035AA <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarCat &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;cat unicode string of int numeric value</span></li><li style="" class="li2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;to unicode string of total</span></li><li style="" class="li1">004035B0 <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">004035B2 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_40<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">004035B5 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarMove &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;copy string of total to [ebp+var_40]</span></li><li style="" class="li2">004035BB <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_58<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">004035BE <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_54<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004035C1 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">004035C2 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li2">004035C3 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">esi</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;esi = 2 (number of vars)</span></li><li style="" class="li1">004035C4 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeStrList &nbsp;<span style="color: #adadad; font-style: italic;">;free temp vars</span></li><li style="" class="li2">004035CA <span style="color: #00007f;">add</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, <span style="color: #ff0000;">0Ch</span></li><li style="" class="li1">004035CD <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_5C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004035D0 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeObj &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;free temp object</span></li><li style="" class="li1">004035D6 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_BC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004035DC <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_AC<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">004035E2 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li2">004035E3 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_8C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">004035E9 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2">004035EA <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_9C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">004035F0 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li2">004035F1 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>total<span style="color: #66cc66;">&#93;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;temp total</span></li><li style="" class="li1">004035F4 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li2">004035F5 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">004035F6 <span style="color: #00007f;">push</span> <span style="color: #ff0000;">5</span></li><li style="" class="li2">004035F8 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeVarList &nbsp; <span style="color: #adadad; font-style: italic;">;free 5 temp vars</span></li><li style="" class="li1">004035FE <span style="color: #00007f;">add</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, 18h</li><li style="" class="li2"><span style="color: #ff0000;">00403601</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_15C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1"><span style="color: #ff0000;">00403607</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_14C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">0040360D <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>counter<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1"><span style="color: #ff0000;">00403610</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;maximum value of counter</span></li><li style="" class="li2"><span style="color: #ff0000;">00403611</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;incremental step</span></li><li style="" class="li1"><span style="color: #ff0000;">00403612</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;actual counter</span></li><li style="" class="li2"><span style="color: #ff0000;">00403613</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarForNext &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;if actual counter &lt; maximum then return true</span></li><li style="" class="li1"><span style="color: #ff0000;">00403619</span> <span style="color: #00007f;">jmp</span> loc_40344D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;else return false</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
this is the loop for serial calculus
<br />

<br />
[asm:nmwo94j5]<div class="asm" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">0040361E EndCheck: <span style="color: #adadad; font-style: italic;">; CODE XREF: Check+18Fj</span></li><li style="" class="li2">0040361E <span style="color: #00007f;">call</span> nullsub_1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;null calls</span></li><li style="" class="li1"><span style="color: #ff0000;">00403623</span> <span style="color: #00007f;">call</span> nullsub_1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;I asked _d31m0s_ to add them</span></li><li style="" class="li2"><span style="color: #ff0000;">00403628</span> <span style="color: #00007f;">call</span> nullsub_1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;just to check some things</span></li><li style="" class="li1">0040362D <span style="color: #00007f;">call</span> nullsub_1</li><li style="" class="li2"><span style="color: #ff0000;">00403632</span> <span style="color: #00007f;">call</span> nullsub_1</li><li style="" class="li1"><span style="color: #ff0000;">00403637</span> <span style="color: #00007f;">call</span> nullsub_1</li><li style="" class="li2">0040363C <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_40<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">0040363F <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_30<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2"><span style="color: #ff0000;">00403642</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;calculated serial (text object)</span></li><li style="" class="li1"><span style="color: #ff0000;">00403643</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;inserted serial (text object)</span></li><li style="" class="li2"><span style="color: #ff0000;">00403644</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaVarTstEq &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;compare the two string objects</span></li><li style="" class="li1">0040364A <span style="color: #00007f;">test</span> <span style="color: #46aa03; font-weight:bold;">ax</span>, <span style="color: #46aa03; font-weight:bold;">ax</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;true = equal, false = different</span></li><li style="" class="li2">0040364D <span style="color: #00007f;">jz</span> <span style="color: #0000ff;">short</span> <span style="color: #0000ff;">Error</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;if strings are different then error message</span></li><li style="" class="li1">0040364F <span style="color: #00007f;">call</span> OkMessage &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;else ok message</span></li><li style="" class="li2"><span style="color: #ff0000;">00403654</span> <span style="color: #00007f;">wait</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;useless waste...</span></li><li style="" class="li1"><span style="color: #ff0000;">00403655</span> <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> loc_4036FE</li><li style="" class="li2">0040365A <span style="color: #00007f;">jmp</span> <span style="color: #0000ff;">short</span> Ending</li><li style="" class="li1">0040365C</li><li style="" class="li2">0040365C <span style="color: #0000ff;">Error</span>:</li><li style="" class="li1">0040365C <span style="color: #00007f;">call</span> ErrorMessage</li><li style="" class="li2"><span style="color: #ff0000;">00403661</span> <span style="color: #00007f;">wait</span></li><li style="" class="li1"><span style="color: #ff0000;">00403662</span> <span style="color: #00007f;">push</span> <span style="color: #0000ff;">offset</span> loc_4036FE</li><li style="" class="li2"><span style="color: #ff0000;">00403667</span> <span style="color: #00007f;">jmp</span> <span style="color: #0000ff;">short</span> Ending</li><li style="" class="li1"><span style="color: #ff0000;">00403669</span></li><li style="" class="li2"><span style="color: #ff0000;">00403669</span> Destructor: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;called in case of error</span></li><li style="" class="li1"><span style="color: #ff0000;">00403669</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp-58h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">0040366C <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-54h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">0040366F <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li2"><span style="color: #ff0000;">00403670</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li1"><span style="color: #ff0000;">00403671</span> <span style="color: #00007f;">push</span> <span style="color: #ff0000;">2</span></li><li style="" class="li2"><span style="color: #ff0000;">00403673</span> <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeStrList</li><li style="" class="li1"><span style="color: #ff0000;">00403679</span> <span style="color: #00007f;">add</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, <span style="color: #ff0000;">0Ch</span></li><li style="" class="li2">0040367C <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-5Ch<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">0040367F <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeObj</li><li style="" class="li2"><span style="color: #ff0000;">00403685</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span>ebp-<span style="color: #ff0000;">0ECh</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">0040368B <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp-<span style="color: #ff0000;">0DCh</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2"><span style="color: #ff0000;">00403691</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li1"><span style="color: #ff0000;">00403692</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-<span style="color: #ff0000;">0CCh</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2"><span style="color: #ff0000;">00403698</span> <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1"><span style="color: #ff0000;">00403699</span> <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span>ebp-<span style="color: #ff0000;"><span style="color: #ff0000;">0B</span>Ch</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">0040369F <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li1">004036A0 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp-<span style="color: #ff0000;">0ACh</span><span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036A6 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li1">004036A7 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-9Ch<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036AD <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">004036AE <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span>ebp-8Ch<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036B4 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li1">004036B5 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span>ebp-7Ch<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036B8 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li1">004036B9 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-6Ch<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036BC <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">004036BD <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">ecx</span></li><li style="" class="li2">004036BE <span style="color: #00007f;">push</span> <span style="color: #ff0000;">9</span></li><li style="" class="li1">004036C0 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeVarList</li><li style="" class="li2">004036C6 <span style="color: #00007f;">add</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, 28h</li><li style="" class="li1">004036C9 <span style="color: #00007f;">retn</span></li><li style="" class="li2">004036CA Ending:</li><li style="" class="li1">004036CA <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">edx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_15C<span style="color: #66cc66;">&#93;</span> &nbsp;<span style="color: #adadad; font-style: italic;">;free vars</span></li><li style="" class="li2">004036D0 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">eax</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_14C<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1">004036D6 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">edx</span></li><li style="" class="li2">004036D7 <span style="color: #00007f;">push</span> <span style="color: #46aa03; font-weight:bold;">eax</span></li><li style="" class="li1">004036D8 <span style="color: #00007f;">push</span> <span style="color: #ff0000;">2</span></li><li style="" class="li2">004036DA <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeVarList</li><li style="" class="li1">004036E0 <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">esi</span>, <span style="color: #46aa03; font-weight:bold;">ds</span>:__vbaFreeVar</li><li style="" class="li2">004036E6 <span style="color: #00007f;">add</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, <span style="color: #ff0000;">0Ch</span></li><li style="" class="li1">004036E9 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>counter<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036EC <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">esi</span> <span style="color: #adadad; font-style: italic;">; __vbaFreeVar</span></li><li style="" class="li1">004036EE <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_30<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036F1 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">esi</span> <span style="color: #adadad; font-style: italic;">; __vbaFreeVar</span></li><li style="" class="li1">004036F3 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_40<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036F6 <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">esi</span> <span style="color: #adadad; font-style: italic;">; __vbaFreeVar</span></li><li style="" class="li1">004036F8 <span style="color: #00007f;">lea</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span><span style="color: #46aa03; font-weight:bold;">ebp</span>+var_50<span style="color: #66cc66;">&#93;</span></li><li style="" class="li2">004036FB <span style="color: #00007f;">call</span> <span style="color: #46aa03; font-weight:bold;">esi</span> <span style="color: #adadad; font-style: italic;">; __vbaFreeVar</span></li><li style="" class="li1">004036FD <span style="color: #00007f;">retn</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;return to 004036FE</span></li><li style="" class="li2">004036FE <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">ecx</span>, <span style="color: #66cc66;">&#91;</span>ebp-10h<span style="color: #66cc66;">&#93;</span></li><li style="" class="li1"><span style="color: #ff0000;">00403701</span> <span style="color: #00007f;">pop</span> <span style="color: #46aa03; font-weight:bold;">edi</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #adadad; font-style: italic;">;save register area</span></li><li style="" class="li2"><span style="color: #ff0000;">00403702</span> <span style="color: #00007f;">pop</span> <span style="color: #46aa03; font-weight:bold;">esi</span></li><li style="" class="li1"><span style="color: #ff0000;">00403703</span> <span style="color: #00007f;">mov</span> <span style="color: #0000ff;">large</span> <span style="color: #46aa03; font-weight:bold;">fs</span>:<span style="color: #ff0000;">0</span>, <span style="color: #46aa03; font-weight:bold;">ecx</span> &nbsp;<span style="color: #adadad; font-style: italic;">;restore seh handler</span></li><li style="" class="li2">0040370A <span style="color: #00007f;">pop</span> <span style="color: #46aa03; font-weight:bold;">ebx</span></li><li style="" class="li1"><span style="color: #ff0000;">004037</span><span style="color: #ff0000;">0B</span> <span style="color: #00007f;">mov</span> <span style="color: #46aa03; font-weight:bold;">esp</span>, <span style="color: #46aa03; font-weight:bold;">ebp</span> &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #adadad; font-style: italic;">;delete private stackframe</span></li><li style="" class="li2">0040370D <span style="color: #00007f;">pop</span> <span style="color: #46aa03; font-weight:bold;">ebp</span></li><li style="" class="li1">0040370E <span style="color: #00007f;">retn</span></li></ol></div>[/asm:nmwo94j5]
<br />

<br />
ok, now we discovered how the serial is built, in particular if you see the __vbaVarTestEq function, the two parameters passed are two string objects, one for serial inserted and one for the correct serial, so you can do serial fishing here without calculating. The algorithm we reversed is:
<br />

<br />
[vb:nmwo94j5]<div class="vb" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">nser = nser &amp; <span style="color: #0000ff;">Int</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">100</span> * <span style="color: #000000;">&#40;</span>i + <span style="color: #000000;">1</span><span style="color: #000000;">&#41;</span> * <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">Val</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">Asc</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">Mid</span><span style="color: #000000;">&#40;</span>Form1.<span style="color: #000000;">Text1</span>, i + <span style="color: #000000;">1</span>, <span style="color: #000000;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> Mod <span style="color: #000000;">10</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span></li></ol></div>[/vb:nmwo94j5]
<br />

<br />
so debugging vb applications is really easy, just keep in mind that functions use Objects instead of direct values. Once you know this, COM jungle will not be a problem!
<br />

<br />
Serial for &quot;AndreaGeddon&quot; is 50000160050042007008000011000, find your own!<br />_________________<br /><span style="font-style: italic">One thing only I know, and that is that I know nothing.</span> (Socrates)</span>
						<span class="gensmall"></span>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="row1" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row1" width="100%" height="28" valign="bottom" nowrap="nowrap"></td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/subSilver/images/spacer.gif" alt="" width="1" height="1" /></td>
		<td></td>
	</tr>
	<tr>
		<td width="150" align="left" valign="top" class="row2"><span class="name"><a name="3834"></a><b>_aLfa_</b></span><br /><span class="postdetails">Site Admin<br /><!--<img src="pro_rank_admin.gif" alt="Site Admin" title="Site Admin" border="0" /><br />--><br /><br />Joined: 21 Sep 2002<br />Posts: 233<br />Location: Aveiro, Portugal</span><br /></td>
		<td class="row2" width="100%" height="28" valign="top">
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
				<tr>
					<td width="100%">
						<span class="postdetails">
							Posted: Fri Feb 15, 2008 11:03 pm
							<span class="gen">&nbsp;</span>&nbsp; &nbsp;Post subject: 3 - SUMMARY
						</span>
					</td>
				</tr>
				<tr>
					<td colspan="2"><hr /></td>
				</tr>
				<tr>
					<td colspan="2">
						<span class="postbody">I hope that at the end of this tutorial you will have learned how to debug visual basic applications. As you can see it is really easy, you do not even need SmartCheck. The exe itself is full of precious infos, you can easily find all event handlers. Then you just have to analyse the code to understand what the program does. Remember that COM tecnology is object based, so when you see functions and you analyse their parameters and return values, you know that you are considering OBJECTS, not the values directly. The values you search (strings, numbers, etc) will be encoded in the object. We encountered alot of rtc* and __vba* apis here, they always use objects, infact when there is an addition you see __vbaVarAdd instead of a simple &quot;add&quot; asm instruction, this is because the function adds two number objects! Naturally the code uses also asm instructions for direct value arithmetics, this happens when there is some casting such as __vbaI4Var function etc etc.
<br />

<br />
I wrote this tute because my intent is vb full decompiling, now that you know the structure of the compiled exes you can understand that decompiling is possible, and is relatively easy. Hope I will write a proggy about this one day!
<br />

<br />
GREETS AND THANKS
<br />

<br />
Thanks to _d31m0s_ who wrote the vb app for this tutorial (I will kill him for lame messages in it!), greets to all RET friends and great reversers! Greets to all UIC members and to all #crack-it people, see you all guys!
<br />

<br />
GoodBye
<br />

<br />
[code=text:275df185]<div class="text" id="{CB}" style="font-family: monospace;"><ol><li style="" class="li1">[AndreaGeddon]   <!-- e --><a href="mailto:andreageddon@hotmail.com">andreageddon@hotmail.com</a><!-- e -->    my mail</li><li style="" class="li2">                 www.andreageddon.8m.com     my lame italian site</li><li style="" class="li1">[RET]            www.reteam.org              RET’s great site</li><li style="" class="li2">[UIC]            www.quequero.org            italian university of cracking</li></ol></div></td>	</tr></table><span class="postbody">
<br />

<br />
<span style="font-weight: bold">Date:</span> December 2003
<br />
<span style="font-weight: bold">Source:</span> <a href="http://www.andreageddon.8m.com/">AndreaGeddon Home Page</a> <br />_________________<br /><span style="font-style: italic">One thing only I know, and that is that I know nothing.</span> (Socrates)</span>
						<span class="gensmall"></span>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td class="row2" width="150" align="left" valign="middle"><span class="nav"><a href="#top" class="nav">Back to top</a></span></td>
		<td class="row2" width="100%" height="28" valign="bottom" nowrap="nowrap"></td>
	</tr>
	<tr>
		<td class="spaceRow" colspan="2" height="1"><img src="templates/subSilver/images/spacer.gif" alt="" width="1" height="1" /></td>
		<td></td>
	</tr>
	<tr align="center">
		<td class="catBottom" colspan="2" height="28"></td>
		<td></td>
	</tr>
</table>

<table width="100%" cellspacing="2" cellpadding="2" border="0" align="center">
  <tr>
	<td></td>
	<td align="left" valign="middle" width="100%"><span class="nav">&nbsp;&nbsp;&nbsp;<a href="index-2.html" class="nav">VB Decompiler Forum Index</a>
	  -> <a href="viewforum8941.html" xx="f=22" class="nav">Articles</a></span></td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">All times are GMT</span><br /><span class="nav"></span>
	  </td>
  </tr>
  <tr>
	<td align="left" colspan="3"><span class="nav">Page <b>1</b> of <b>1</b></span></td>
  </tr>
</table>

<table width="100%" cellspacing="2" border="0" align="center">
  <tr>
	<td width="40%" valign="top" nowrap="nowrap" align="left"><span class="gensmall"></span><br />
	  &nbsp;<br />
	  </td>
	<td align="right" valign="top" nowrap="nowrap"><span class="gensmall">You <b>can</b> post new topics in this forum<br />You <b>can</b> reply to topics in this forum<br />You <b>can</b> edit your posts in this forum<br />You <b>can</b> delete your posts in this forum<br />You <b>can</b> vote in polls in this forum<br /></span></td>
  </tr>
</table>


<div align="center"><span class="copyright"><br /><br />
<!--
	We request you retain the full copyright notice below including the link to www.phpbb.com.
	This not only gives respect to the large amount of time given freely by the developers
	but also helps build interest, traffic and use of phpBB 2.0. If you cannot (for good
	reason) retain the full copyright we request you at least leave in place the
	Powered by phpBB line, with phpBB linked to www.phpbb.com. If you refuse
	to include even this then support on our forums may be affected.

	The phpBB Group : 2002
// -->
Powered by <a href="http://www.phpbb.com/" target="_phpbb" class="copyright">phpBB</a> &copy; 2001, 2005 phpBB Group<br /></span></div>
		</td>
	</tr>
</table>

</body>

<!-- Mirrored from localhost/phpbb2/viewtopic.php?t=2492&start=0&postdays=0&postorder=asc&highlight= by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Mar 2018 20:55:27 GMT -->
</html>

